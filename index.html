<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bitcoin Bro Maker</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>

<body class="bg-gray-200">
  <div class="container mx-auto p-4">
    <h1 class="text-3xl font-bold mb-4">Bitcoin Bro Maker</h1>

    <div class="grid grid-cols-5">
        <div class="col-span-2">
            <form id="bro-form" class="max-w-md bg-white p-4 rounded shadow-md">
                <div class="mb-4">
                    <label class="block mb-2 font-bold" for="background">Background:</label>
                    <select onchange="generateBro()" id="background" name="background" class="block w-full p-2 border border-gray-300 rounded">
                    </select>
                  </div>  
        
            <div class="mb-4">
                <label class="block mb-2 font-bold" for="skin">Skin:</label>
                <select onchange="generateBro()" id="skin" name="skin" class="block w-full p-2 border border-gray-300 rounded">
                </select>
              </div>
        
              <div class="mb-4">
                <label class="block mb-2 font-bold" for="dress">Dress:</label>
                <select onchange="generateBro()" id="dress" name="dress" class="block w-full p-2 border border-gray-300 rounded">
                </select>
              </div>
        
              <div class="mb-4">
                <label class="block mb-2 font-bold" for="face">Face:</label>
                <select onchange="generateBro()" id="face" name="face" class="block w-full p-2 border border-gray-300 rounded">
                </select>
              </div>
        
              <div class="mb-4">
                <label class="block mb-2 font-bold" for="head">Head:</label>
                <select onchange="generateBro()" id="head" name="head" class="block w-full p-2 border border-gray-300 rounded">
                </select>
              </div>
        
              <div class="mb-4">
                <label class="block mb-2 font-bold" for="eyes">Eyes:</label>
                <select onchange="generateBro()" id="eyes" name="eyes" class="block w-full p-2 border border-gray-300 rounded">
                </select>
              </div>
        
              <div class="mb-4">
                <label class="block mb-2 font-bold" for="eyewear">Eyewear:</label>
                <select onchange="generateBro()" id="eyewear" name="eyewear" class="block w-full p-2 border border-gray-300 rounded">
                </select>
              </div>
        
              <div class="mb-4">
                <label class="block mb-2 font-bold" for="beard">Beard:</label>
                <select onchange="generateBro()" id="beard" name="beard" class="block w-full p-2 border border-gray-300 rounded">
                </select>
              </div>
        
              <button id="generate-btn" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="button" onclick="generateBro()">Generate Bro</button>
              <button id="random-btn" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="button" onclick="randomBro()">Randomise</button>
            </form>
        </div>
        <div class="col-span-3" style="max-width: 600px;">
            <div id="result" class="mt-4 mb-4">
              
              </div>
              <div>
                <a id="download-btn" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" style="margin-top: 10px; display: none; margin: 0 auto; width: 150px; text-align: center;" onclick="download()" download="bro.svg">Download</a>
              </div>
        </div>
    </div>
  </div>
  <script>

      // Assuming you have an array of folder names
  const folderNames = ['background', 'beard', 'dress', 'eyes', 'eyewear', 'face', 'head', 'skin'];

  // Function to read a CSV file and return its contents as an array
  function readCSV(file) {
    // Replace this with your own CSV reading logic
    // Here's a simplified example assuming the CSV is already loaded as a string
    const csvString = file;
    const lines = csvString.split('\n');
    return lines.map(line => line.trim());
  }

  // Function to populate a select element with options
  function populateSelect(selectId, options) {
    const select = document.getElementById(selectId);
    options.forEach(option => {
      const optionElement = document.createElement('option');
      optionElement.text = option;
      select.add(optionElement);
    });
  }

  window.onload = folderNames.forEach(folderName => {
    // Replace 'csvFiles/folderName.csv' with the actual file path
    fetch(`assets/${folderName}/list.csv`)
      .then(response => response.text())
      .then(csvData => {
        const options = readCSV(csvData);
        populateSelect(folderName, options);
      })
      .catch(error => {
        console.error(`Error loading CSV file for ${folderName}:`, error);
      });
  });

    function randomBro() {
      document.getElementById('background').value = Math.floor(Math.random() * 11);
      document.getElementById('skin').value = Math.floor(Math.random() * 12);
      document.getElementById('dress').value = Math.floor(Math.random() * 72);
      document.getElementById('face').value = Math.floor(Math.random() * 19);
      document.getElementById('eyes').value = Math.floor(Math.random() * 13);
      document.getElementById('eyewear').value = Math.floor(Math.random() * 17);
      document.getElementById('head').value = Math.floor(Math.random() * 71);
      document.getElementById('beard').value = Math.floor(Math.random() * 8);
      generateBro();
    }

    const downloadLink = document.getElementById('download-btn');
    downloadLink.addEventListener('click', () => {
      downloadLink.href = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(document.getElementById('result').innerHTML);
    });

    function generateBro() {
      document.getElementById('download-btn').style.display = 'block';
      const formData = new FormData(document.getElementById('bro-form'));
      const params = new URLSearchParams(formData).toString();

  // Adjust the API endpoint URL accordingly
  const apiUrl = 'http://localhost:3000/generate?' + params;

  fetch(apiUrl)
  .then(response => response.json())
  .then(data => {
    // Handle the response data
    console.log(data);
    document.getElementById('result').innerHTML = data.bro;
  })
  .catch(error => {
    // Handle any errors that occurred during the request
    console.error(error);
  });
    }
  </script>
</body>

</html>
